<!DOCTYPE html>
<html lang="pl">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>BSO Projekt â€“ Symulator Kodowania Gold</title>
        <link rel="stylesheet" href="/static/style.css">
        <script src="https://unpkg.com/htmx.org@1.9.10" crossorigin="anonymous"></script>
    </head>
    <body>
        <div class="main-title">BSO Projekt - Symulator Kodu Golda</div>
        <div class="subtitle">Karol Adamski, BartÅ‚omiej Masiak</div>
        
        <form hx-post="/simulate" 
            hx-target="#simulation-status"
            hx-swap="innerHTML">
            <div class="modules-grid responsive-grid">
                <div class="card" id="card-generator">
                    <div class="card-header"><span class="icon">ðŸ“‹</span>Dane WejÅ›ciowe</div>
                    <div class="card-config">
                        <label>Tekst do zakodowania:
                            <input type="text" name="seqText" placeholder="np. hello world">
                        </label>
                        <label>DÅ‚ugoÅ›Ä‡ losowej sekwencji:
                            <input type="number" name="seqLength" value="64" min="1" max="256">
                        </label>
                    </div>
                    <div class="card-result" 
                        id="result-generator"
                        hx-get="/generator"
                        hx-trigger="simulation-complete from:body"
                        hx-target="#result-generator"
                        hx-swap="innerHTML">(wynik pojawi siÄ™ po uruchomieniu)</div>
                </div>
                <div class="card" id="card-encoder">
                    <div class="card-header"><span class="icon">ðŸ”‘</span>Konfiguracja Kodu Gold</div>
                    <div class="card-config">
                        <label>DÅ‚ugoÅ›Ä‡ rejestru (n):
                            <input type="number" name="goldN" value="10" min="2" max="16">
                        </label>
                        <label>LFSR1 Taps (przecinek):
                            <input type="text" name="goldTaps1" value="0,3">
                        </label>
                        <label>LFSR2 Taps (przecinek):
                            <input type="text" name="goldTaps2" value="0,2,3,8">
                        </label>
                    </div>
                    <div class="card-result" 
                        id="result-encoder"
                        hx-get="/encoder"
                        hx-trigger="simulation-complete from:body"
                        hx-target="#result-encoder"
                        hx-swap="innerHTML">(wynik pojawi siÄ™ po uruchomieniu)</div>
                </div>
                <div class="card" id="card-error">
                    <div class="card-header">
                        <input type="checkbox" name="errorEnabled" checked onchange="toggleModule(this, 'card-error')"> <span class="icon">âš¡</span>Dodawanie BÅ‚Ä™dÃ³w
                    </div>
                    <div class="card-config">
                        <label>Typ bÅ‚Ä™du:
                            <select name="errorType">
                                <option value="random">Losowy</option>
                                <option value="burst">Seria (burst)</option>
                            </select>
                        </label>
                        <label>PrawdopodobieÅ„stwo [%]:
                            <input type="number" name="errorRate" value="5" min="0" max="100">
                        </label>
                    </div>
                    <div class="card-result" 
                        id="result-error"
                        hx-get="/error"
                        hx-trigger="simulation-complete from:body"
                        hx-target="#result-error"
                        hx-swap="innerHTML">(wynik pojawi siÄ™ po uruchomieniu)</div>
                </div>
                <div class="card" id="card-decoder">
                    <div class="card-header">
                        <input type="checkbox" name="decoderEnabled" checked onchange="toggleModule(this, 'card-decoder')"> 
                        <span class="icon">ðŸ”’</span>Dekoder
                    </div>
                    <div class="card-config">
                        <label>Typ dekodera:
                            <select name="decoderType">
                                <option value="xor">Prosty XOR</option>
                            </select>
                        </label>
                    </div>
                    <div class="card-result" 
                        id="result-decoder"
                        hx-get="/decoder"
                        hx-trigger="simulation-complete from:body"
                        hx-target="#result-decoder"
                        hx-swap="innerHTML">(wynik pojawi siÄ™ po uruchomieniu)</div>
                </div>
                
                <div class="card" id="card-ber">
                    <div class="card-header">
                        <input type="checkbox" name="berEnabled" checked onchange="toggleModule(this, 'card-ber')"> 
                        <span class="icon">ðŸ“Š</span>Analiza BER
                    </div>
                    <div class="card-config">
                        <span>PorÃ³wnanie oryginaÅ‚u i wyjÅ›cia dekodera</span>
                    </div>
                    <div class="card-result" 
                        id="result-ber"
                        hx-get="/ber"
                        hx-trigger="simulation-complete from:body"
                        hx-target="#result-ber"
                        hx-swap="innerHTML">(wynik pojawi siÄ™ po uruchomieniu)</div>
                </div>
                
                <div class="card" id="card-autocorrelation">
                    <div class="card-header">
                        <input type="checkbox" name="autocorrEnabled" checked onchange="toggleModule(this, 'card-autocorrelation')"> 
                        <span class="icon">ðŸ“ˆ</span>Analiza Autokorelacji
                    </div>
                    <div class="card-config">
                        <span>Analiza autokorelacji dla wszystkich ciÄ…gÃ³w</span>
                    </div>
                    <div class="card-result" 
                        id="result-autocorrelation"
                        hx-get="/autocorrelation"
                        hx-trigger="simulation-complete from:body"
                        hx-target="#result-autocorrelation"
                        hx-swap="innerHTML">(wynik pojawi siÄ™ po uruchomieniu)</div>
                </div>
            </div>
            <div class="actions">
                <button type="submit" class="btn-main">Uruchom SymulacjÄ™</button>
                <button type="reset" class="btn-reset">Reset Konfiguracji</button>
            </div>
        </form>
        
        <div id="simulation-status"></div>
        
        <div id="results"></div>
         
        <script>
            function toggleModule(checkbox, cardId) {
                var card = document.getElementById(cardId);
                if (!card) return;
                if (checkbox.checked) {
                    card.classList.remove('module-disabled');
                } else {
                    card.classList.add('module-disabled');
                }
            }
            // PrzywrÃ³Ä‡ stan po odÅ›wieÅ¼eniu (np. po reset)
            window.addEventListener('DOMContentLoaded', function() {
                document.querySelectorAll('.card-header input[type=checkbox]').forEach(function(cb) {
                    toggleModule(cb, cb.closest('.card').id);
                });
            });
        </script>
    </body>
</html>
