<!DOCTYPE html>
<html lang="pl">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>BSO Projekt â€“ Symulator Kodowania Gold</title>
        <link rel="stylesheet" href="/static/style.css">
        <script src="https://unpkg.com/htmx.org@1.9.10" crossorigin="anonymous"></script>
    </head>
    <body>
        <div class="main-title">BSO Projekt - Symulator Kodu Golda</div>
        <div class="subtitle">Karol Adamski, BartÅ‚omiej Masiak</div>
        
        <form hx-post="/simulate" 
            hx-target="#simulation-status"
            hx-swap="innerHTML">
            <div class="modules-grid responsive-grid">
                <div class="card" id="card-generator">
                    <div class="card-header"><span class="icon">ðŸ“‹</span>Dane WejÅ›ciowe</div>
                    <div class="card-config">
                        <label>Tekst do zakodowania:
                            <input type="text" name="seqText" placeholder="np. hello world">
                        </label>
                        <label>DÅ‚ugoÅ›Ä‡ losowej sekwencji:
                            <input type="number" name="seqLength" value="64" min="1" max="256">
                        </label>
                    </div>
                    <div class="card-result" 
                        id="result-generator"
                        hx-get="/generator"
                        hx-trigger="simulation-complete from:body"
                        hx-target="#result-generator"
                        hx-swap="innerHTML">(wynik pojawi siÄ™ po uruchomieniu)</div>
                </div>
                <div class="card" id="card-encoder">
                    <div class="card-header"><span class="icon">ðŸ”‘</span>Konfiguracja Kodu Gold</div>
                    <div class="card-config">
                        <label>DÅ‚ugoÅ›Ä‡ rejestru (n):
                            <input type="number" name="goldN" value="10" min="2" max="16">
                        </label>
                        <label>LFSR1 Taps (przecinek):
                            <input type="text" name="goldTaps1" value="0,3">
                        </label>
                        <label>LFSR2 Taps (przecinek):
                            <input type="text" name="goldTaps2" value="0,2,3,8">
                        </label>
                    </div>
                    <div class="card-result" 
                        id="result-encoder"
                        hx-get="/encoder"
                        hx-trigger="simulation-complete from:body"
                        hx-target="#result-encoder"
                        hx-swap="innerHTML">(wynik pojawi siÄ™ po uruchomieniu)</div>
                </div>
                <div class="card" id="card-error">
                    <div class="card-header">
                        <input type="checkbox" name="errorEnabled" checked onchange="toggleModule(this, 'card-error')"> <span class="icon">âš¡</span>Dodawanie BÅ‚Ä™dÃ³w
                    </div>
                    <div class="card-config">
                        <label>Typ bÅ‚Ä™du:
                            <select name="errorType">
                                <option value="random">Losowy</option>
                                <option value="burst">Seria (burst)</option>
                            </select>
                        </label>
                        <label>PrawdopodobieÅ„stwo [%]:
                            <input type="number" name="errorRate" value="5" min="0" max="100">
                        </label>
                    </div>
                    <div class="card-result" 
                        id="result-error"
                        hx-get="/error"
                        hx-trigger="simulation-complete from:body"
                        hx-target="#result-error"
                        hx-swap="innerHTML">(wynik pojawi siÄ™ po uruchomieniu)</div>
                </div>
                <div class="card" id="card-decoder">
                    <div class="card-header">
                        <input type="checkbox" name="decoderEnabled" checked onchange="toggleModule(this, 'card-decoder')"> 
                        <span class="icon">ðŸ”’</span>Dekoder
                    </div>
                    <div class="card-config">
                        <label>Typ dekodera:
                            <select name="decoderType">
                                <option value="xor">Prosty XOR</option>
                            </select>
                        </label>
                    </div>
                    <div class="card-result" 
                        id="result-decoder"
                        hx-get="/decoder"
                        hx-trigger="simulation-complete from:body"
                        hx-target="#result-decoder"
                        hx-swap="innerHTML">(wynik pojawi siÄ™ po uruchomieniu)</div>
                </div>
                
                <div class="card" id="card-ber">
                    <div class="card-header">
                        <input type="checkbox" name="berEnabled" checked onchange="toggleModule(this, 'card-ber')"> 
                        <span class="icon">ðŸ“Š</span>Analiza BER
                    </div>
                    <div class="card-config">
                        <span>PorÃ³wnanie oryginaÅ‚u i wyjÅ›cia dekodera</span>
                    </div>
                    <div class="card-result" 
                        id="result-ber"
                        hx-get="/ber"
                        hx-trigger="simulation-complete from:body"
                        hx-target="#result-ber"
                        hx-swap="innerHTML">(wynik pojawi siÄ™ po uruchomieniu)</div>
                </div>
                
                <div class="card" id="card-autocorrelation">
                    <div class="card-header">
                        <input type="checkbox" name="autocorrEnabled" checked onchange="toggleModule(this, 'card-autocorrelation')"> 
                        <span class="icon">ðŸ“ˆ</span>Analiza Autokorelacji
                    </div>
                    <div class="card-config">
                        <span>Analiza autokorelacji dla wszystkich ciÄ…gÃ³w</span>
                    </div>
                    <div class="card-result" 
                        id="result-autocorrelation"
                        hx-get="/autocorrelation"
                        hx-trigger="simulation-complete from:body"
                        hx-target="#result-autocorrelation"
                        hx-swap="innerHTML">(wynik pojawi siÄ™ po uruchomieniu)</div>
                </div>
            </div>
            <div class="actions">
                <button type="submit" class="btn-main">Uruchom SymulacjÄ™</button>
                <button type="reset" class="btn-reset">Reset Konfiguracji</button>
            </div>
        </form>
        
        <div id="simulation-status"></div>

        <!-- Sekcja dla symulacji CDMA -->
        <div class="main-title" style="margin-top: 40px;">Symulacja CDMA - Wielu UÅ¼ytkownikÃ³w</div>
        <form hx-post="/cdma-simulate"
              hx-target="#cdma-simulation-status"
              hx-swap="innerHTML"
              id="cdmaForm">
            <div class="modules-grid responsive-grid">

                <!-- ModuÅ‚ 1: Konfiguracja Systemu -->
                <div class="card" id="card-cdma-module1">
                    <div class="card-header"><span class="icon">ðŸ”‘</span>Konfiguracja Systemu CDMA</div>
                    <div class="card-config">
                        <label>DÅ‚ugoÅ›Ä‡ rejestru (n):
                            <input type="number" name="cdmaGoldN" value="10" min="2" max="16">
                        </label>
                        <label>LFSR1 Taps (przecinek):
                            <input type="text" name="cdmaGoldTaps1" value="0,3">
                        </label>
                        <label>LFSR2 Taps (przecinek):
                            <input type="text" name="cdmaGoldTaps2" value="0,2,3,8">
                        </label>
                    </div>
                    <div class="card-result"
                         id="result-cdma-module1"
                         hx-get="/cdma-system-config"
                         hx-trigger="cdma-simulation-complete from:body"
                         hx-target="#result-cdma-module1"
                         hx-swap="innerHTML">(konfiguracja systemu)</div>
                </div>

                <!-- ModuÅ‚ 2: Nadajniki -->
                <div class="card" id="card-cdma-module2a">
                    <div class="card-header"><span class="icon">ðŸ“¡</span>Nadajnik A</div>
                    <div class="card-config">
                        <label>Tekst do wysÅ‚ania:
                            <input type="text" name="cdmaTextUserA" placeholder="np. Ala ma kota" maxlength="50">
                        </label>
                        <label>Stan poczÄ…tkowy LFSR1:
                            <input type="number" name="cdmaSeedA1" value="1">
                        </label>
                        <label>Stan poczÄ…tkowy LFSR2:
                            <input type="number" name="cdmaSeedA2" value="1">
                        </label>
                    </div>
                    <div class="card-result"
                         id="result-cdma-module2a"
                         hx-get="/cdma-transmitter-a-results"
                         hx-trigger="cdma-simulation-complete from:body"
                         hx-target="#result-cdma-module2a"
                         hx-swap="innerHTML">(nadajnik A)</div>
                </div>
                
                <div class="card" id="card-cdma-module2b">
                    <div class="card-header"><span class="icon">ðŸ“¡</span>Nadajnik B</div>
                    <div class="card-config">
                        <label>Tekst do wysÅ‚ania:
                            <input type="text" name="cdmaTextUserB" placeholder="np. Jan ma psa" maxlength="50">
                        </label>
                        <label>Stan poczÄ…tkowy LFSR1:
                            <input type="number" name="cdmaSeedB1" value="2">
                        </label>
                        <label>Stan poczÄ…tkowy LFSR2:
                            <input type="number" name="cdmaSeedB2" value="2">
                        </label>
                    </div>
                    <div class="card-result"
                         id="result-cdma-module2b"
                         hx-get="/cdma-transmitter-b-results"
                         hx-trigger="cdma-simulation-complete from:body"
                         hx-target="#result-cdma-module2b"
                         hx-swap="innerHTML">(nadajnik B)</div>
                </div>

                <!-- ModuÅ‚ 3: KanaÅ‚ Komunikacyjny -->
                <div class="card" id="card-cdma-module3">
                    <div class="card-header"><span class="icon">ðŸŒŠ</span>WspÃ³lny KanaÅ‚</div>
                    <div class="card-config">
                        <label>Poziom szumu [%]:
                            <input type="number" name="cdmaNoiseLevel" value="5" step="0.5" min="0">
                        </label>
                        <label>DÅ‚ugoÅ›Ä‡ los. sekw. jeÅ›li tekst pusty (bajty):
                            <input type="number" name="cdmaSeqLengthRandom" value="1" min="1" max="3">
                        </label>
                    </div>
                    <div class="card-result"
                         id="result-cdma-module3"
                         hx-get="/cdma-channel-results"
                         hx-trigger="cdma-simulation-complete from:body"
                         hx-target="#result-cdma-module3"
                         hx-swap="innerHTML">(kanaÅ‚ komunikacyjny)</div>
                </div>

                <!-- ModuÅ‚ 4: Odbiorniki -->
                <div class="card" id="card-cdma-module4a">
                    <div class="card-header"><span class="icon">ðŸŽ§</span>Odbiornik A</div>
                    <div class="card-result"
                         id="result-cdma-module4a"
                         hx-get="/cdma-receiver-a-results"
                         hx-trigger="cdma-simulation-complete from:body"
                         hx-target="#result-cdma-module4a"
                         hx-swap="innerHTML">(odbiornik A)</div>
                </div>
                
                <div class="card" id="card-cdma-module4b">
                    <div class="card-header"><span class="icon">ðŸŽ§</span>Odbiornik B</div>
                    <div class="card-result"
                         id="result-cdma-module4b"
                         hx-get="/cdma-receiver-b-results"
                         hx-trigger="cdma-simulation-complete from:body"
                         hx-target="#result-cdma-module4b"
                         hx-swap="innerHTML">(odbiornik B)</div>
                </div>

                <!-- ModuÅ‚ 5: Analiza BER -->
                <div class="card" id="card-cdma-module5a">
                    <div class="card-header"><span class="icon">ðŸ“Š</span>Analiza BER (UÅ¼ytkownik A)</div>
                    <div class="card-result"
                         id="result-cdma-module5a"
                         hx-get="/cdma-ber-a-results"
                         hx-trigger="cdma-simulation-complete from:body"
                         hx-target="#result-cdma-module5a"
                         hx-swap="innerHTML">(analiza BER A)</div>
                </div>
                
                <div class="card" id="card-cdma-module5b">
                    <div class="card-header"><span class="icon">ðŸ“Š</span>Analiza BER (UÅ¼ytkownik B)</div>
                    <div class="card-result"
                         id="result-cdma-module5b"
                         hx-get="/cdma-ber-b-results"
                         hx-trigger="cdma-simulation-complete from:body"
                         hx-target="#result-cdma-module5b"
                         hx-swap="innerHTML">(analiza BER B)</div>
                </div>

                <!-- ModuÅ‚ 6: Analiza WÅ‚aÅ›ciwoÅ›ci KodÃ³w -->
                <div class="card" id="card-cdma-module6">
                    <div class="card-header"><span class="icon">ðŸ“ˆ</span>Analiza WÅ‚aÅ›ciwoÅ›ci KodÃ³w</div>
                    <div class="card-result"
                         id="result-cdma-module6"
                         hx-get="/cdma-code-analysis"
                         hx-trigger="cdma-simulation-complete from:body"
                         hx-target="#result-cdma-module6"
                         hx-swap="innerHTML">(wÅ‚aÅ›ciwoÅ›ci kodÃ³w)</div>
                </div>
            </div>
            <div class="actions">
                <button type="submit" class="btn-main">Uruchom SymulacjÄ™ CDMA</button>
                 <button type="button" class="btn-reset" onclick="resetCdmaForm()">Reset CDMA</button>
            </div>
        </form>
        <div id="cdma-simulation-status"></div>
        
        <div id="results"></div>
         
        <script>
            function toggleModule(checkbox, cardId) {
                var card = document.getElementById(cardId);
                if (!card) return;
                if (checkbox.checked) {
                    card.classList.remove('module-disabled');
                } else {
                    card.classList.add('module-disabled');
                }
            }
            // PrzywrÃ³Ä‡ stan po odÅ›wieÅ¼eniu (np. po reset)
            window.addEventListener('DOMContentLoaded', function() {
                document.querySelectorAll('.card-header input[type=checkbox]').forEach(function(cb) {
                    toggleModule(cb, cb.closest('.card').id);
                });
            });

            function resetAllForms() {
                // Reset main form
                document.querySelector('form[hx-post="/simulate"]').reset();
                // Reset CDMA form
                document.getElementById('cdmaForm').reset();

                // Clear result areas for main simulation
                document.getElementById('result-generator').innerHTML = '(wynik pojawi siÄ™ po uruchomieniu)';
                document.getElementById('result-encoder').innerHTML = '(wynik pojawi siÄ™ po uruchomieniu)';
                document.getElementById('result-error').innerHTML = '(wynik pojawi siÄ™ po uruchomieniu)';
                document.getElementById('result-decoder').innerHTML = '(wynik pojawi siÄ™ po uruchomieniu)';
                document.getElementById('result-ber').innerHTML = '(wynik pojawi siÄ™ po uruchomieniu)';
                document.getElementById('result-autocorrelation').innerHTML = '(wynik pojawi siÄ™ po uruchomieniu)';
                document.getElementById('simulation-status').innerHTML = '';

                // Clear result areas for CDMA simulation
                document.getElementById('result-cdma-module1').innerHTML = '(konfiguracja systemu)';
                document.getElementById('result-cdma-module2a').innerHTML = '(nadajnik A)';
                document.getElementById('result-cdma-module2b').innerHTML = '(nadajnik B)';
                document.getElementById('result-cdma-module3').innerHTML = '(kanaÅ‚ komunikacyjny)';
                document.getElementById('result-cdma-module4a').innerHTML = '(odbiornik A)';
                document.getElementById('result-cdma-module4b').innerHTML = '(odbiornik B)';
                document.getElementById('result-cdma-module5a').innerHTML = '(analiza BER A)';
                document.getElementById('result-cdma-module5b').innerHTML = '(analiza BER B)';
                document.getElementById('result-cdma-module6').innerHTML = '(wÅ‚aÅ›ciwoÅ›ci kodÃ³w)';
                document.getElementById('cdma-simulation-status').innerHTML = '';

                // Re-apply toggle state for checkboxes in main form
                 document.querySelectorAll('form[hx-post="/simulate"] .card-header input[type=checkbox]').forEach(function(cb) {
                    toggleModule(cb, cb.closest('.card').id);
                });
            }

            function resetCdmaForm() {
                document.getElementById('cdmaForm').reset();
                document.getElementById('result-cdma-module1').innerHTML = '(konfiguracja systemu)';
                document.getElementById('result-cdma-module2a').innerHTML = '(nadajnik A)';
                document.getElementById('result-cdma-module2b').innerHTML = '(nadajnik B)';
                document.getElementById('result-cdma-module3').innerHTML = '(kanaÅ‚ komunikacyjny)';
                document.getElementById('result-cdma-module4a').innerHTML = '(odbiornik A)';
                document.getElementById('result-cdma-module4b').innerHTML = '(odbiornik B)';
                document.getElementById('result-cdma-module5a').innerHTML = '(analiza BER A)';
                document.getElementById('result-cdma-module5b').innerHTML = '(analiza BER B)';
                document.getElementById('result-cdma-module6').innerHTML = '(wÅ‚aÅ›ciwoÅ›ci kodÃ³w)';
                document.getElementById('cdma-simulation-status').innerHTML = '';
            }
        </script>
    </body>
</html>
